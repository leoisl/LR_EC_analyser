#Running gmap:
#How we built the index
gmap_build -D /data2/ASTER/nanopore_mouse/Our_mapping_to_mRNA_only/gmap_genome -d GRCm38 /data2/ASTER/nanopore_mouse/genomic_data/Mus_musculus.GRCm38.dna.primary_assembly.fa

#mapping
GMAP_GENOME_DIR=/data2/ASTER/nanopore_mouse/Our_mapping_to_mRNA_only/gmap_genome
GMAP_GENOME_NAME=GRCm38
gmap -D $GMAP_GENOME_DIR -d $GMAP_GENOME_NAME -n 10 -t $THREADS -f samse $RAW_READS_FILE >  ${OUTPUT_PREFIX}.gmap.sam

#from sam to bam
samtools view -S -o ${OUTPUT_PREFIX}.gmap.bam ${OUTPUT_PREFIX}.gmap.sam
rm ${OUTPUT_PREFIX}.gmap.sam


#Running minimap2:
GENOME_PATH=/data2/ASTER/nanopore_mouse/genomic_data/Mus_musculus.GRCm38.dna.primary_assembly.fa
/data2/ASTER/tools/Minimap2-2.14/minimap2-2.14_x64-linux/minimap2 -ax splice $GENOME_PATH $RAW_READS_FILE > ${OUTPUT_PREFIX}.minimap2.sam

#running on all tools
GENOME_PATH=/data2/ASTER/nanopore_mouse/genomic_data/Mus_musculus.GRCm38.dna.primary_assembly.fa
/data2/ASTER/tools/Minimap2-2.14/minimap2-2.14_x64-linux/minimap2 -ax splice -t 8 $GENOME_PATH /data2/ASTER/error_correction/LoRDEC/minimap2_bam/BYK_CB_ONT_1_FAF04998_A_1Donly.no_mito.no_rDNA.lordec.fasta > /data2/ASTER/error_correction/LoRDEC/minimap2_bam/LoRDEC.minimap2.sam
/data2/ASTER/tools/Minimap2-2.14/minimap2-2.14_x64-linux/minimap2 -ax splice -t 8 $GENOME_PATH /data2/ASTER/error_correction/LoRMA/minimap2_bam/BYK_CB_ONT_1_FAF04998_A_1Donly.no_mito.no_rDNA.lorma.fasta > /data2/ASTER/error_correction/LoRMA/minimap2_bam/LoRMA.minimap2.sam
/data2/ASTER/tools/Minimap2-2.14/minimap2-2.14_x64-linux/minimap2 -ax splice -t 8 $GENOME_PATH /data2/ASTER/error_correction/proovread_trimmed/minimap2_bam/proovread.trimmed.fa > /data2/ASTER/error_correction/proovread_trimmed/minimap2_bam/proovread.minimap2.sam
/data2/ASTER/tools/Minimap2-2.14/minimap2-2.14_x64-linux/minimap2 -ax splice -t 8 $GENOME_PATH /data2/ASTER/error_correction/canu/minimap2_bam/BYK_CB_ONT_1_FAF04998_A_1Donly.no_mito.no_rDNA.canu.correctedReads.fasta > /data2/ASTER/error_correction/canu/minimap2_bam/canu.minimap2.sam

#from sam to bam
samtools view -S -o ${OUTPUT_PREFIX}.minimap2.bam ${OUTPUT_PREFIX}.minimap2.sam
rm ${OUTPUT_PREFIX}.minimap2.sam





#command-line to run LR_EC_analyser and compare both mappers:
source venv/bin/activate
python /data2/ASTER/error_correction/LR_EC_analyser/run_LR_EC_analyser.py --genome /data2/ASTER/nanopore_mouse/genomic_data/Mus_musculus.GRCm38.dna.primary_assembly.fa --gtf /data2/ASTER/nanopore_mouse/transcriptomic_data/Mus_musculus.GRCm38.87.gtf -o gmap_vs_minimap2/output -t 8 --paralogous /data2/ASTER/nanopore_mouse/transcriptomic_data/Mus_musculus.GRCm38.87.paralog_genes.80_percent_plus_identity.txt --raw /data2/ASTER/error_correction/raw_1D_only_data_no_mito_no_rDNA/gmap_bam/raw.gmap.bam --hybrid /data2/ASTER/error_correction/raw_1D_only_data_no_mito_no_rDNA/minimap2_bam/raw.minimap2.bam /data2/ASTER/error_correction/LoRDEC/gmap_bam/LoRDEC.gmap.bam /data2/ASTER/error_correction/LoRDEC/minimap2_bam/LoRDEC.minimap2.bam /data2/ASTER/error_correction/proovread_trimmed/gmap_bam/proovread_trimmed.gmap.bam /data2/ASTER/error_correction/proovread_trimmed/minimap2_bam/proovread.minimap2.bam --self /data2/ASTER/error_correction/LoRMA/gmap_bam/LoRMA.gmap.bam /data2/ASTER/error_correction/LoRMA/minimap2_bam/LoRMA.minimap2.bam /data2/ASTER/error_correction/canu/gmap_bam/canu.gmap.bam /data2/ASTER/error_correction/canu/minimap2_bam/canu.minimap2.bam --colours FF0000 F16666 00009C 6666FF 006400 7FE37F 654321 E4C2A0 FF00FF FF7FFF --skip_bam_process --skip_alignqc --skip_copying
deactivate
